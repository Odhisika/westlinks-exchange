{% extends "base.html" %}
{% load static %}

{% block title %}Sell Crypto - CoinVibe Pay{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section">
    <div class="cvp-container">
        <div class="hero-grid">
            <div class="hero-content" style="text-align: left;">
                <div class="hero-badge">
                    <i data-lucide="trending-up"></i>
                    Best Rates in Ghana
                </div>
                <h1 class="hero-title">Sell your Bitcoin and Perfect Money in Ghana easily</h1>
                <p class="hero-subtitle">
                    Convert your cryptocurrency to Ghana Cedis instantly. Get paid directly to your mobile money account
                    in minutes.
                </p>
                <div class="hero-cta">
                    <button onclick="handleSellNow()" class="btn btn-success btn-lg">
                        <i data-lucide="banknote"></i>
                        Sell now!
                    </button>
                    <a href="/about" class="btn btn-secondary btn-lg">
                        <i data-lucide="info"></i>
                        Learn More
                    </a>
                </div>

                <!-- Trust Indicators -->
                <div class="trust-indicators" style="margin-top: 2rem;">
                    <div class="trust-item">
                        <div class="trust-icon" style="color: var(--highlight-green);">
                            <i data-lucide="percent"></i>
                        </div>
                        <div>
                            <div class="trust-value text-green">1.5%</div>
                            <div class="trust-label">Low Fees</div>
                        </div>
                    </div>
                    <div class="trust-item">
                        <div class="trust-icon" style="color: var(--highlight-green);">
                            <i data-lucide="clock"></i>
                        </div>
                        <div>
                            <div class="trust-value text-green">5 min</div>
                            <div class="trust-label">Fast Payout</div>
                        </div>
                    </div>
                    <div class="trust-item">
                        <div class="trust-icon" style="color: var(--highlight-green);">
                            <i data-lucide="shield"></i>
                        </div>
                        <div>
                            <div class="trust-value text-green">100%</div>
                            <div class="trust-label">Secure</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Hero Card -->
            <div class="hero-rates-card">
                <div class="rates-header">
                    <h3>Current Sell Rate</h3>
                    <div class="live-indicator">
                        <span class="pulse-dot"></span>
                        Live
                    </div>
                </div>

                <div class="rate-item" style="background: var(--bg-card); border: none; margin-bottom: 1.5rem;">
                    <div class="rate-label">
                        <i data-lucide="trending-down"></i>
                        1 USDT
                    </div>
                    <div class="rate-value text-green" id="heroSellRate">₵--</div>
                    <div class="rate-sub">Ghana Cedis</div>
                </div>

                <div class="wallet-info">
                    <div class="wallet-label">
                        <i data-lucide="info"></i>
                        Quick Calculation
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">
                        <div>
                            <div class="text-muted" style="font-size: 0.75rem; margin-bottom: 0.5rem;">You Send</div>
                            <div class="text-primary" style="font-size: 1.25rem; font-weight: 700;">100 USDT</div>
                        </div>
                        <div>
                            <div class="text-muted" style="font-size: 0.75rem; margin-bottom: 0.5rem;">You Get</div>
                            <div class="text-green" style="font-size: 1.25rem; font-weight: 700;" id="heroQuickCalc">₵--
                            </div>
                        </div>
                    </div>
                    <div class="text-muted" style="font-size: 0.75rem; margin-top: 0.5rem;">After 1.5% fee</div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- How It Works Section -->
<section class="how-it-works">
    <div class="cvp-container">
        <div class="section-header">
            <h2>How to Sell Crypto in 3 Easy Steps</h2>
            <p>Turn your cryptocurrency into cash quickly and safely.</p>
        </div>

        <div class="steps-grid">
            <div class="step-card">
                <div class="step-number">1</div>
                <div class="step-icon">
                    <i data-lucide="user-check"></i>
                </div>
                <h3>Login to Your Account</h3>
                <p>Access your dashboard and navigate to the sell section. If you don't have an account, sign up in
                    seconds.</p>
            </div>

            <div class="step-card">
                <div class="step-number">2</div>
                <div class="step-icon">
                    <i data-lucide="send"></i>
                </div>
                <h3>Send Crypto to Our Wallet</h3>
                <p>Transfer your cryptocurrency to the provided wallet address. Enter your mobile money details for
                    payout.</p>
            </div>

            <div class="step-card">
                <div class="step-number">3</div>
                <div class="step-icon">
                    <i data-lucide="check-circle"></i>
                </div>
                <h3>Receive Cash Instantly</h3>
                <p>Once we confirm your transaction, receive Ghana Cedis directly to your mobile money account!</p>
            </div>
        </div>
    </div>
</section>

<!-- Features Section -->
<section class="features-section">
    <div class="cvp-container">
        <div class="section-header">
            <h2>Why Sell with CoinVibe Pay?</h2>
            <p>The fastest way to convert crypto to cash in Ghana</p>
        </div>
        <div class="features-grid">
            <div class="feature-card">
                <div class="feature-icon" style="background: linear-gradient(135deg, var(--highlight-green), #2dd4a0);">
                    <i data-lucide="banknote"></i>
                </div>
                <h3>Competitive Rates</h3>
                <p>Get the best exchange rates in Ghana. We update our rates in real-time to ensure you always get top
                    value.</p>
                <ul class="feature-list">
                    <li><i data-lucide="check"></i> Real-time market rates</li>
                    <li><i data-lucide="check"></i> Transparent pricing</li>
                    <li><i data-lucide="check"></i> No hidden charges</li>
                </ul>
            </div>

            <div class="feature-card">
                <div class="feature-icon"
                    style="background: linear-gradient(135deg, var(--highlight-yellow), #f5c842);">
                    <i data-lucide="smartphone"></i>
                </div>
                <h3>Mobile Money Payout</h3>
                <p>Receive your funds directly to MTN, AirtelTigo, or Vodafone Cash. No bank account needed.</p>
                <ul class="feature-list">
                    <li><i data-lucide="check"></i> All mobile networks supported</li>
                    <li><i data-lucide="check"></i> Instant transfers</li>
                    <li><i data-lucide="check"></i> No withdrawal limits</li>
                </ul>
            </div>

            <div class="feature-card">
                <div class="feature-icon" style="background: linear-gradient(135deg, var(--highlight-cyan), #00d4ff);">
                    <i data-lucide="lock"></i>
                </div>
                <h3>Safe & Secure</h3>
                <p>Your transactions are protected with enterprise-grade security. We hold your crypto safely until
                    payment is complete.</p>
                <ul class="feature-list">
                    <li><i data-lucide="check"></i> Escrow protection</li>
                    <li><i data-lucide="check"></i> Verified transactions</li>
                    <li><i data-lucide="check"></i> Fraud prevention</li>
                </ul>
            </div>
        </div>
    </div>
</section>

<!-- Supported Assets -->
<section class="trading-section">
    <div class="cvp-container">
        <div class="section-header">
            <h2>Supported Cryptocurrencies</h2>
            <p>Sell multiple cryptocurrencies on various networks</p>
        </div>

        <div class="glass-card">
            <div
                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: var(--spacing-lg);">
                <div class="crypto-card" style="text-align: center;">
                    <div class="asset-icon"
                        style="background: linear-gradient(135deg, #26A17B, #2dd4a0); margin: 0 auto 1rem;">₮</div>
                    <h4>USDT</h4>
                    <p class="text-secondary" style="font-size: 0.875rem;">Multiple Networks</p>
                    <div class="payment-methods" style="justify-content: center; margin-top: 0.75rem;">
                        <span class="payment-badge">TRC20</span>
                        <span class="payment-badge">ERC20</span>
                        <span class="payment-badge">BEP20</span>
                    </div>
                </div>

                <div class="crypto-card" style="text-align: center;">
                    <div class="asset-icon"
                        style="background: linear-gradient(135deg, #F7931A, #f5c842); margin: 0 auto 1rem;">₿</div>
                    <h4>Bitcoin</h4>
                    <p class="text-secondary" style="font-size: 0.875rem;">BTC Network</p>
                    <div class="payment-methods" style="justify-content: center; margin-top: 0.75rem;">
                        <span class="payment-badge">Bitcoin</span>
                    </div>
                </div>

                <div class="crypto-card" style="text-align: center;">
                    <div class="asset-icon"
                        style="background: linear-gradient(135deg, #eb2f96, #f759ab); margin: 0 auto 1rem;">PM</div>
                    <h4>Perfect Money</h4>
                    <p class="text-secondary" style="font-size: 0.875rem;">USD Wallet</p>
                    <div class="payment-methods" style="justify-content: center; margin-top: 0.75rem;">
                        <span class="payment-badge">PM USD</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- CTA Section -->
<section class="cta-section">
    <div class="cvp-container">
        <div class="cta-content">
            <h2>Start Selling Cryptocurrency Today</h2>
            <p>Convert your digital assets to cash in minutes. Fast, secure, and reliable.</p>
            <div class="cta-buttons">
                <button onclick="handleSellNow()" class="btn btn-success btn-lg">
                    <i data-lucide="rocket"></i>
                    Sell Now
                </button>
                <a href="/buy-crypto" class="btn btn-secondary btn-lg">
                    <i data-lucide="arrow-left-right"></i>
                    Want to Buy Instead?
                </a>
            </div>
        </div>
    </div>
</section>

<script>
    // Load and display current sell rate
    async function loadSellRate() {
        try {
            const res = await fetch(`${API_URL}/public/settings`);
            const data = await res.json();
            if (data.success && data.settings) {
                const sellRate = Number(data.settings.sell_rate) || 14.80;
                document.getElementById('heroSellRate').textContent = `₵${sellRate.toFixed(2)}`;

                // Calculate quick preview (100 USDT)
                const ghsAmount = 100 * sellRate;
                const fee = ghsAmount * 0.015;
                const total = ghsAmount - fee;
                document.getElementById('heroQuickCalc').textContent = `₵${total.toFixed(2)}`;
            }
        } catch (e) {
            console.error('Failed to load sell rate:', e);
        }
    }

    // Handle Sell Now button click
    function handleSellNow() {
        const token = localStorage.getItem('coinvibe_token');
        const loggedIn = !!(token && token !== 'null' && token !== 'undefined' && token !== '');

        if (loggedIn) {
            // User is logged in, go to actual sell page
            window.location.href = '/sell';
        } else {
            // User is not logged in, go to login page
            window.location.href = '/login?next=/sell';
        }
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', function () {
        loadSellRate();
        if (window.lucide && lucide.createIcons) lucide.createIcons();
    });
</script>
{% endblock %}