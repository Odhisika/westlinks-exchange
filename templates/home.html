{% extends 'base.html' %}
{% block title %}WestLinks - P2P Crypto Trading Platform{% endblock %}
{% block content %}
<!-- Hero Section -->
<section class="hero-section">
  <div class="cvp-container">
    <div class="hero-grid">
      <!-- Hero Content -->
      <div class="hero-content">
        <h1 class="hero-title">Trade Crypto Instantly with Ghana Cedis</h1>
        <p class="hero-subtitle">Buy and sell USDT using Mobile Money. Fast, secure, and reliable P2P trading platform
          built for Africa.</p>
        <!-- Trust Indicators -->
        <div class="trust-indicators">
          <div class="trust-item">
            <div class="trust-icon">
              <i data-lucide="shield-check"></i>
            </div>
            <div>
              <div class="trust-value">100%</div>
              <div class="trust-label">Secure</div>
            </div>
          </div>
          <div class="trust-item">
            <div class="trust-icon">
              <i data-lucide="zap"></i>
            </div>
            <div>
              <div class="trust-value">&lt;60s</div>
              <div class="trust-label">Fast Payout</div>
            </div>
          </div>
          <div class="trust-item">
            <div class="trust-icon">
              <i data-lucide="users"></i>
            </div>
            <div>
              <div class="trust-value">10K+</div>
              <div class="trust-label">Users</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Live Rates Card -->
      <div class="hero-rates-card">
        <div class="rates-header">
          <h3>Live Exchange Rates</h3>
          <div class="live-indicator">
            <div class="pulse-dot"></div>
            <span>Live</span>
          </div>
        </div>

        <div class="rates-grid">
          <!-- Buy Rate -->
          <div class="rate-item">
            <div class="rate-label">
              <i data-lucide="arrow-down-circle" style="width: 18px; height: 18px; color: var(--highlight-yellow);"></i>
              <span>Buy Rate</span>
            </div>
            <div class="rate-value text-yellow" id="heroBuyRate">₵--</div>
            <div class="rate-sub">per 1 USDT</div>
          </div>

          <!-- Sell Rate -->
          <div class="rate-item">
            <div class="rate-label">
              <i data-lucide="arrow-up-circle" style="width: 18px; height: 18px; color: var(--highlight-green);"></i>
              <span>Sell Rate</span>
            </div>
            <div class="rate-value text-green" id="heroSellRate">₵--</div>
            <div class="rate-sub">per 1 USDT</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Stats Bar -->
<section class="stats-bar">
  <div class="cvp-container">
    <div class="stats-grid">
      <div class="stat-item">
        <div class="stat-icon">
          <i data-lucide="activity"></i>
        </div>
        <div>
          <div class="stat-value" id="totalVolume">₵0</div>
          <div class="stat-label">24h Volume</div>
        </div>
      </div>
      <div class="stat-item">
        <div class="stat-icon">
          <i data-lucide="repeat"></i>
        </div>
        <div>
          <div class="stat-value" id="totalTrades">0</div>
          <div class="stat-label">Completed Trades</div>
        </div>
      </div>
      <div class="stat-item">
        <div class="stat-icon">
          <i data-lucide="users"></i>
        </div>
        <div>
          <div class="stat-value">10,000+</div>
          <div class="stat-label">Active Users</div>
        </div>
      </div>
      <div class="stat-item">
        <div class="stat-icon">
          <i data-lucide="clock"></i>
        </div>
        <div>
          <div class="stat-value">&lt; 60s</div>
          <div class="stat-label">Avg. Payout Time</div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- How It Works -->
<section class="how-it-works">
  <div class="cvp-container">
    <div class="section-header">
      <h2>How It Works</h2>
      <p>Start trading in three simple steps</p>
    </div>

    <div class="steps-grid">
      <div class="step-card">
        <div class="step-number">1</div>
        <div class="step-icon">
          <i data-lucide="user-plus"></i>
        </div>
        <h3>Create Account</h3>
        <p>Sign up in seconds with just your email. No complicated verification process.</p>
      </div>

      <div class="step-card">
        <div class="step-number">2</div>
        <div class="step-icon">
          <i data-lucide="repeat"></i>
        </div>
        <h3>Choose Trade</h3>
        <p>Select buy or sell, enter amount, and get instant quote with live rates.</p>
      </div>

      <div class="step-card">
        <div class="step-number">3</div>
        <div class="step-icon">
          <i data-lucide="check-circle"></i>
        </div>
        <h3>Complete Trade</h3>
        <p>Send payment or crypto. Get instant confirmation and payout to your wallet.</p>
      </div>
    </div>
  </div>
</section>

<!-- Crypto Prices Section -->
<section class="trading-section">
  <div class="cvp-container">
    <div class="section-header">
      <h2>Market Trends</h2>
      <p>Live prices from the global crypto market</p>
    </div>

    <div class="trading-table-wrapper" style="max-width: 600px; margin: 0 auto;">
      {% include 'cryptoprices.html' %}
    </div>
  </div>
</section>

<!-- Features Section -->
<section class="features-section">
  <div class="cvp-container">
    <div class="section-header">
      <h2>Why WestLinks?</h2>
      <p>Why choose WestLinks over other P2P crypto trading platforms?</p>
    </div>

    <div class="features-grid">
      <div class="feature-card">
        <div class="feature-icon"
          style="background: linear-gradient(135deg, var(--highlight-cyan), #33dfff); box-shadow: var(--glow-cyan);">
          <i data-lucide="wallet"></i>
        </div>
        <h3>Multiple Options</h3>
        <p>Supports TRC20 & ERC20 networks. Trade with MTN, Vodafone, or AirtelTigo.</p>
        <ul class="feature-list">
          <li><i data-lucide="check"></i> TRC20 & ERC20</li>
          <li><i data-lucide="check"></i> All MoMo providers</li>
          <li><i data-lucide="check"></i> Flexible limits</li>
        </ul>
      </div>

      <div class="feature-card">
        <div class="feature-icon"
          style="background: linear-gradient(135deg, #a855f7, #c084fc); box-shadow: 0 0 20px rgba(168, 85, 247, 0.3);">
          <i data-lucide="headphones"></i>
        </div>
        <h3>24/7 Support</h3>
        <p>Our dedicated support team is always ready to help you with any questions.</p>
        <ul class="feature-list">
          <li><i data-lucide="check"></i> WhatsApp chat support</li>
          <li><i data-lucide="check"></i> Email support</li>
          <li><i data-lucide="check"></i> FAQ & guides</li>
        </ul>
      </div>

      <div class="feature-card">
        <div class="feature-icon"
          style="background: linear-gradient(135deg, #f97316, #fb923c); box-shadow: 0 0 20px rgba(249, 115, 22, 0.3);">
          <i data-lucide="trending-up"></i>
        </div>
        <h3>Best Rates</h3>
        <p>Competitive exchange rates updated in real-time for the best value.</p>
        <ul class="feature-list">
          <li><i data-lucide="check"></i> Live market rates</li>
          <li><i data-lucide="check"></i> No hidden fees</li>
          <li><i data-lucide="check"></i> Transparent pricing</li>
        </ul>
      </div>
    </div>
  </div>
</section>

<!-- CTA Section -->
<section class="cta-section">
  <div class="cvp-container">
    <div class="cta-content">
      <h2>Ready to Start Trading?</h2>
      <p>Join thousands of traders already using WestLinks for fast, secure crypto trading</p>
      <div class="cta-buttons">
        <a href="/register" class="btn btn-primary btn-lg">
          <i data-lucide="user-plus" style="width: 20px; height: 20px;"></i>
          Create Free Account
        </a>
        <a href="/buy" class="btn btn-secondary btn-lg">
          <i data-lucide="arrow-right" style="width: 20px; height: 20px;"></i>
          Start Trading
        </a>
      </div>
    </div>
  </div>
</section>

<script>
  // API_URL is already defined in base.html

  // Copy wallet address
  function copyWallet() {
    const wallet = document.getElementById('heroWallet').textContent;
    if (wallet && wallet !== '--') {
      navigator.clipboard.writeText(wallet).then(() => {
        alert('Wallet address copied to clipboard!');
      }).catch(err => {
        console.error('Failed to copy:', err);
      });
    }
  }

  // Format number with commas
  function formatNumber(num) {
    return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
  }

  // Update rates from API
  function updateRates() {
    fetch(`${API_URL}/public/settings`)
      .then(r => r.json())
      .then(d => {
        const s = d.settings || {};
        if (s.buy_rate) {
          const rate = Number(s.buy_rate).toFixed(2);
          document.getElementById('heroBuyRate').textContent = `₵${rate}`;
        }
        if (s.sell_rate) {
          const rate = Number(s.sell_rate).toFixed(2);
          document.getElementById('heroSellRate').textContent = `₵${rate}`;
        }
        if (s.usdt_wallet_address) {
          document.getElementById('heroWallet').textContent = s.usdt_wallet_address;
        }
      })
      .catch(err => console.error('Failed to fetch rates:', err));
  }

  // Fetch platform stats
  function updateStats() {
    fetch(`${API_URL}/public/stats`)
      .then(r => r.json())
      .then(d => {
        if (d.success) {
          if (d.volume) {
            document.getElementById('totalVolume').textContent = `₵${formatNumber(Math.round(d.volume))}`;
          }
          if (d.trades) {
            document.getElementById('totalTrades').textContent = formatNumber(d.trades);
          }
        }
      })
      .catch(err => {
        // Set demo values if API fails
        document.getElementById('totalVolume').textContent = '₵2.5M';
        document.getElementById('totalTrades').textContent = '15,234';
      });
  }

  // Initialize
  document.addEventListener('DOMContentLoaded', function () {
    if (window.lucide && lucide.createIcons) {
      lucide.createIcons();
    }
    // Ensure mobile menu is initialized
    if (typeof initMobileMenu === 'function') {
      initMobileMenu();
    }
    updateRates();
    updateStats();

    // Update rates every 30 seconds
    setInterval(updateRates, 30000);
    // Update stats every 60 seconds
    setInterval(updateStats, 60000);
  });
</script>
{% endblock %}