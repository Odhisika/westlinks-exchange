{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sell Order Placed â€¢ WestLinks Exchange</title>
    <link rel="stylesheet" href="{% static 'css/modern_base.css' %}">
    <link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
    <script src="https://unpkg.com/lucide@latest"></script>
</head>

<body>
    <header class="cvp-header">
        <div class="cvp-header-inner">
            <a href="/" class="cvp-brand">
                <img src="{% static 'images/logo.jpg' %}" alt="WestLinks Exchange" style="height: 36px; width: auto;">
                <span style="margin-left: 0.75rem;">WestLinks Exchange</span>
            </a>
            <nav class="cvp-nav">
                <a href="/dashboard" class="cvp-link">Dashboard</a>
                <a href="/profile" class="cvp-link">Profile</a>
            </nav>
        </div>
    </header>

    <section class="cvp-container" style="margin-top: 3rem; margin-bottom: 3rem;">
        <div class="glass-card" style="max-width: 720px; margin: 0 auto; padding: 2rem;">
            <div style="display:flex; align-items:center; gap:1rem;">
                <i id="successIcon" data-lucide="check-circle" style="width: 40px; height: 40px;"></i>
                <div>
                    <h1 id="successTitle" style="font-size:1.75rem; font-weight:800; margin:0;">Processing...</h1>
                    <p id="successMsg" class="text-secondary" style="margin-top:0.25rem;">Please wait while we verify
                        your order details.</p>
                </div>
            </div>

            <div style="margin-top:1.5rem; display:grid; grid-template-columns:1fr 1fr; gap:1rem;">
                <div class="glass-card" style="padding:1rem;">
                    <div class="text-secondary" style="font-size:0.875rem;">Reference</div>
                    <div id="refLabel" class="font-mono" style="font-weight:600;">--</div>
                </div>
                <div class="glass-card" style="padding:1rem;">
                    <div class="text-secondary" style="font-size:0.875rem;">Status</div>
                    <div id="statusLabel" style="font-weight:600; color: var(--text-secondary);">--</div>
                </div>
            </div>

            <div style="margin-top:2rem; display:flex; gap:0.75rem;">
                <a id="dashboardBtn" href="/dashboard" class="btn btn-secondary">Go to Dashboard</a>
                <a href="/sell" class="btn btn-primary">Start a New Sell</a>
            </div>
        </div>
    </section>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            if (window.lucide && lucide.createIcons) lucide.createIcons();

            // Parse URL parameters
            const urlParams = new URLSearchParams(window.location.search);
            const paymentId = urlParams.get('id');

            if (paymentId) {
                // Success state
                document.getElementById('successIcon').style.color = 'var(--highlight-green)';
                document.getElementById('successTitle').textContent = 'Sell Order Placed';
                document.getElementById('successMsg').textContent = 'Your sell order has been placed successfully. Once we verify the crypto transfer, funds will be sent to your mobile money wallet.';
                document.getElementById('refLabel').textContent = paymentId;
                document.getElementById('statusLabel').textContent = 'Pending (Success)';
                document.getElementById('statusLabel').style.color = 'var(--highlight-green)';
                document.getElementById('dashboardBtn').classList.add('btn-success');
                document.getElementById('dashboardBtn').classList.remove('btn-secondary');
            } else {
                // Failed or unknown state (default)
                document.getElementById('successIcon').style.color = '#ef4444';
                document.getElementById('successIcon').setAttribute('data-lucide', 'alert-circle');
                if (window.lucide && lucide.createIcons) lucide.createIcons();
                document.getElementById('successTitle').textContent = 'Order Submission Failed';
                document.getElementById('successMsg').textContent = 'We could not place your sell order at the moment. Please try again or contact support if the issue persists.';
                document.getElementById('refLabel').textContent = '--';
                document.getElementById('statusLabel').textContent = 'Failed';
                document.getElementById('statusLabel').style.color = '#ef4444';
                document.getElementById('dashboardBtn').classList.add('btn-secondary');
                document.getElementById('dashboardBtn').classList.remove('btn-success');
            }
        });
    </script>
</body>

</html>